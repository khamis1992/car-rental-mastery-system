# وحدة التقارير المحاسبية والتحليلية المتقدمة

## نظرة عامة
تم إنشاء وحدة تقارير محاسبية وتحليلية متقدمة متكاملة بالكامل مع النظام المحاسبي المطبق حسب شجرة الحسابات ذات الـ 7 أرقام. هذه الوحدة مصممة لتوفير تحليلات مالية شاملة ومرتبطة فعلياً بنظام العقود والعملاء.

## المميزات الرئيسية

### 1. التكامل الكامل مع شجرة الحسابات
- ربط مباشر بشجرة الحسابات المحاسبية 7 أرقام
- تطبيق تلقائي للقيود المحاسبية
- التزام كامل بالمعايير المحاسبية

### 2. التقارير المتاحة
- **كشف حساب العميل**: تفاصيل العمليات المالية لكل عميل
- **التقرير التحليلي للعميل**: تحليل مالي شامل ومؤشرات الأداء
- **التقرير المجمع للعملاء**: نظرة شاملة على جميع العملاء
- **تقرير الأصول الثابتة**: إدارة الأصول والإهلاك التلقائي
- **لوحة المعلومات**: مؤشرات رئيسية ورسوم بيانية

### 3. القيود المحاسبية التلقائية
- قيود الفواتير والمدفوعات
- قيود الغرامات والخصومات
- قيود الإهلاك الشهرية
- قيود إكمال العقود

## الملفات المُنشأة

### الصفحات الرئيسية
- `src/pages/AccountingReports.tsx` - الصفحة الرئيسية للتقارير
- `src/components/Accounting/AccountingDashboard.tsx` - لوحة المعلومات
- `src/components/Accounting/CustomerStatementReport.tsx` - كشف حساب العميل
- `src/components/Accounting/CustomerAnalyticsReport.tsx` - التحليل التفصيلي للعميل
- `src/components/Accounting/CustomersOverviewReport.tsx` - التقرير المجمع للعملاء
- `src/components/Accounting/FixedAssetsReport.tsx` - تقرير الأصول الثابتة

### الخدمات
- `src/services/accountingReportsService.ts` - خدمة البيانات المحاسبية
- `src/services/accountingExportService.ts` - خدمة التصدير والطباعة
- `src/services/automatedJournalService.ts` - خدمة القيود التلقائية

### المكونات المساعدة
- `src/components/ui/date-picker-range.tsx` - مكون اختيار الفترة الزمنية

## التقارير المفصلة

### 1. كشف حساب العميل
**الموقع**: `/accounting-reports` -> تبويب "كشف حساب العميل"

**المميزات**:
- عرض جميع العمليات المالية للعميل
- فلترة حسب الفترة الزمنية، نوع العملية، المركبة، والفرع
- عرض الرصيد الحالي والتاريخي
- تصدير وطباعة مع شعار الشركة

**البيانات المعروضة**:
- اسم العميل ورقم العقد
- تاريخ ونوع العملية
- المبلغ والرصيد
- اسم المستخدم والمركبة والفرع

**الحسابات المرتبطة**:
- `1130101` - عملاء تجاريون شركات
- `1130201` - عملاء أفراد
- `1130301` - عملاء حكوميون

### 2. التقرير التحليلي للعميل
**الموقع**: `/accounting-reports` -> تبويب "التحليل التفصيلي للعميل"

**التحليلات المقدمة**:
- إجمالي الإيرادات المتحصلة
- عدد العقود ومتوسط مدة التأجير
- نسبة التحصيل: (المدفوع ÷ الفواتير) × 100
- إجمالي الغرامات والمدفوعة
- أكثر المركبات استئجاراً والفروع تعاملاً

**الرسوم البيانية**:
- توزيع الإيرادات مقابل المدفوعات
- حالة الغرامات (مدفوعة/متبقية)
- الاتجاه الشهري للإيرادات والمدفوعات
- الجدول الزمني للعقود

### 3. التقرير المجمع للعملاء
**الموقع**: `/accounting-reports` -> تبويب "التقرير المجمع للعملاء"

**المميزات**:
- قائمة شاملة لجميع العملاء
- ترتيب حسب المديونية، التحصيل، عدد العقود
- فلترة حسب الحالة وأيام التأخير
- إرسال تذكيرات للعملاء المتأخرين

**البيانات المعروضة**:
- معلومات العميل الأساسية
- عدد العقود والرصيد الحالي
- نسبة التحصيل وعدد الغرامات
- حالة العميل وأيام التأخير

### 4. تقرير الأصول الثابتة
**الموقع**: `/accounting-reports` -> تبويب "تقرير الأصول الثابتة"

**المميزات**:
- إدارة شاملة للأصول الثابتة
- حساب الإهلاك التلقائي
- تطبيق القيود المحاسبية شهرياً
- تتبع القيمة الدفترية

**البيانات المعروضة**:
- كود الأصل ومعلومات المركبة
- القيمة الأصلية ومعدل الإهلاك
- الإهلاك الشهري والمجمع
- القيمة الدفترية الحالية

**الحسابات المرتبطة**:
- `1210101` - مخصص إهلاك السيارات والباصات
- `5130101` - مصروف إهلاك السيارات والباصات
- `5130102` - مصروف إهلاك الباصات
- `5130103` - مصروف إهلاك الشاحنات

## القيود المحاسبية التلقائية

### 1. قيد الفاتورة
```
مدين: 1130101 (العميل)
دائن: 4110101 (إيرادات التأجير)
```

### 2. قيد الدفعة
```
مدين: 1110101 (النقدية)
دائن: 1130101 (العميل)
```

### 3. قيد الغرامة
```
مدين: 1130101 (العميل)
دائن: 4310104 (إيرادات أخرى)
```

### 4. قيد الإهلاك الشهري
```
مدين: 5130101 (مصروف إهلاك)
دائن: 1210101 (مخصص إهلاك)
```

### 5. قيد إكمال العقد
```
مدين: 2120101 (ودائع العملاء)
دائن: 1110101 (النقدية)
```

## التصدير والطباعة

### صيغ التصدير المتاحة
- **PDF**: مع شعار الشركة وتوقيعات المحاسب والمدير المالي
- **Excel**: لجداول البيانات والتحليلات

### معلومات الطباعة
- شعار الشركة
- تاريخ الطباعة
- توقيع المحاسب: أحمد محمد المحاسب
- توقيع المدير المالي: محمد أحمد المدير المالي

## إعدادات النظام

### معلومات الشركة
```javascript
{
  name: 'نظام إدارة تأجير السيارات',
  address: 'الرياض، المملكة العربية السعودية',
  phone: '+966 11 234 5678',
  email: 'info@car-rental.com',
  accountantName: 'أحمد محمد المحاسب',
  managerName: 'محمد أحمد المدير المالي'
}
```

## الوصول للنظام

### الرابط المباشر
`/accounting-reports`

### من الشريط الجانبي
المالية → التقارير المحاسبية

### الصلاحيات المطلوبة
- مُحاسب أو أعلى
- عضوية فعالة في المؤسسة

## الميزات التقنية

### الأداء والتحسين
- تحميل البيانات بشكل تدريجي
- حفظ تلقائي للفلاتر
- تحديث مباشر للبيانات

### الأمان
- فلترة البيانات حسب المؤسسة
- تشفير البيانات المحاسبية
- سجل المراجعة للعمليات

### سهولة الاستخدام
- واجهة مستخدم باللغة العربية
- رسوم بيانية تفاعلية
- بحث وفلترة متقدمة

## التوسعات المستقبلية

### المرحلة الثانية
- تقارير الإيرادات حسب الفروع
- تحليلات مقارنة شهرية وسنوية
- تقارير الربحية حسب المركبة
- تحليلات التنبؤ المالي

### المرحلة الثالثة
- تكامل مع أنظمة محاسبية خارجية
- إشعارات تلقائية للتنبيهات المالية
- تقارير مخصصة حسب المستخدم
- لوحة معلومات تفاعلية للإدارة العليا

## الدعم الفني

### المشاكل الشائعة
1. **عدم ظهور البيانات**: تأكد من اختيار العميل والفترة الزمنية
2. **خطأ في التصدير**: تأكد من وجود بيانات للتصدير
3. **عدم تطبيق الإهلاك**: تأكد من تشغيل الإهلاك الشهري

### طلب الدعم
- البريد الإلكتروني: support@car-rental.com
- الهاتف: +966 11 234 5678
- التذاكر الفنية: من خلال لوحة الإعدادات

## التحديثات والصيانة

### تحديثات تلقائية
- تحديث البيانات كل 5 دقائق
- تحديث الرسوم البيانية فوري
- حفظ تلقائي للتفضيلات

### صيانة دورية
- نسخ احتياطي يومي للبيانات
- تنظيف السجلات القديمة شهرياً
- مراجعة الأداء أسبوعياً

---

**تم إنشاء هذا النظام بالكامل وفقاً لمتطلبات العميل ومتكامل مع النظام المحاسبي الموجود بشجرة الحسابات 7 أرقام.** 